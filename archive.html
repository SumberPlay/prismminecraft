<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>P.R.I.S.M. | SECURE TERMINAL</title>
    <style>
        :root { 
            --neon-blue: #00ffcc; --neon-green: #00ff41; --neon-red: #ff3333; 
            --bg-dark: #050505; --border: #1a3a3a; --font-main: 'Courier New', monospace;
        }
        * { box-sizing: border-box; }
        body { background: var(--bg-dark); color: #ccc; font-family: var(--font-main); margin: 0; height: 100vh; overflow: hidden; text-transform: uppercase; }
        
        /* Эффекты */
        .overlay { position: fixed; inset: 0; background: repeating-linear-gradient(0deg, rgba(0,0,0,0.1) 0px, transparent 2px); pointer-events: none; z-index: 9000; }
        .scanline { position: fixed; top: 0; left: 0; width: 100%; height: 4px; background: rgba(0, 255, 204, 0.03); z-index: 9001; pointer-events: none; animation: scan 8s linear infinite; }
        @keyframes scan { from { top: -10%; } to { top: 110%; } }

        #access-screen { position: fixed; inset: 0; z-index: 10000; background: #000; display: flex; align-items: center; justify-content: center; }
        #main-interface { display: none; height: 100vh; grid-template-rows: 60px 1fr; }
        
        header { height: 60px; border-bottom: 1px solid var(--border); background: #080808; display: flex; align-items: center; justify-content: space-between; padding: 0 25px; }
        .val { color: var(--neon-green); font-weight: bold; }

        .workspace { display: grid; grid-template-columns: 260px 1fr; height: calc(100vh - 60px); }
        aside { border-right: 1px solid var(--border); background: #020202; }
        .nav-btn { padding: 18px 25px; color: #777; cursor: pointer; border-left: 2px solid transparent; transition: 0.3s; }
        .nav-btn.active { color: var(--neon-blue); border-left-color: var(--neon-blue); background: rgba(0,255,204,0.05); }

        .view-section { display: none; height: 100%; grid-template-columns: 320px 1fr; } 
        .view-section.active { display: grid; }

        /* СКРОЛЛ КОЛОНКИ */
        .list-column { height: 100%; overflow-y: auto; border-right: 1px solid var(--border); }
        .viewer-column { height: 100%; overflow-y: auto; padding: 40px; scroll-behavior: smooth; }

        .list-item { padding: 20px; border-bottom: 1px solid #111; cursor: pointer; display: flex; align-items: center; gap: 15px; opacity: 0.7; }
        .list-item:hover, .list-item.active { opacity: 1; background: rgba(255,255,255,0.02); }
        .list-item.active { border-left: 3px solid var(--neon-blue); }
        
        .dossier-img { width: 160px; height: 160px; border: 1px solid #333; margin-bottom: 20px; }
        .text-content { font-size: 0.95em; color: #aaa; line-height: 1.6; white-space: pre-wrap; padding-bottom: 80px; }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #222; }
        ::-webkit-scrollbar-thumb:hover { background: var(--neon-blue); }
    </style>
</head>
<body>

<div class="overlay"></div><div class="scanline"></div>

<div id="access-screen"><div id="status-box" style="color: var(--neon-blue)">СКАНИРОВАНИЕ...</div></div>

<div id="main-interface">
    <header>
        <div>P.R.I.S.M. // DATABASE_V4</div>
        <div style="font-size: 0.8em">USER: <span id="u-name" class="val"></span> | <span id="u-level" class="val"></span></div>
    </header>
    <div class="workspace">
        <aside>
            <div class="nav-btn active" onclick="switchModule('anomalies', this)">РЕЕСТР АНОМАЛИЙ</div>
            <div class="nav-btn" onclick="switchModule('staff', this)">ЛИЧНЫЕ ДЕЛА</div>
            <div class="nav-btn" onclick="switchModule('archive', this)">АРХИВ</div>
        </aside>
        <main>
            <div id="mod-anomalies" class="view-section active">
                <div class="list-column" id="anomaly-list"></div>
                <div class="viewer-column" id="ano-viewer">
                    <div id="ano-content" style="display:none;">
                        <img id="a-img" class="dossier-img">
                        <h1 id="a-title" style="color: #fff"></h1>
                        <div id="a-desc" class="text-content"></div>
                    </div>
                </div>
            </div>
            <div id="mod-staff" class="view-section">
                <div class="list-column" id="staff-list"></div>
                <div class="viewer-column" id="staff-viewer">
                    <div id="staff-content" style="display:none;">
                        <img id="s-img" class="dossier-img">
                        <h1 id="s-name" style="color: #fff"></h1>
                        <div id="s-bio" class="text-content"></div>
                    </div>
                </div>
            </div>
            <div id="mod-archive" class="view-section">
                <div class="list-column" id="archive-list"></div>
                <div class="viewer-column" id="archive-viewer">
                    <div id="archive-content" style="display:none;">
                        <h1 id="r-title" style="color: #fff"></h1>
                        <div id="r-text" class="text-content"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
    const RENDER_API = "https://prism-bot.onrender.com";
    const GITHUB_JSON = "https://raw.githubusercontent.com/SumberPlay/prismminecraft/main/data/archive.json";
    
    const ANOMALIES = [
        { id: "001", code: "КОНЕЦ", lvl: 4, desc: "Точка сингулярности..." },
        { id: "004", code: "ЭХО", lvl: 2, desc: "Акустический феномен..." }
    ];

    let USER = { name: "", level: 0 };
    let typeTimer = null;

    window.onload = () => {
        const n = localStorage.getItem('prism_name');
        const l = localStorage.getItem('prism_level');
        if(n) { USER.name = n; USER.level = parseInt(l); initInterface(); }
        else { document.getElementById('status-box').innerText = "ACCESS DENIED"; }
    };

    function initInterface() {
        document.getElementById('access-screen').style.display = 'none';
        document.getElementById('main-interface').style.display = 'grid';
        document.getElementById('u-name').innerText = USER.name;
        document.getElementById('u-level').innerText = "L" + USER.level;
        renderAnomalyList();
        loadStaff();
        loadArchive();
    }

    function switchModule(id, btn) {
        document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('mod-'+id).classList.add('active');
        btn.classList.add('active');
    }

    function renderAnomalyList() {
        const list = document.getElementById('anomaly-list');
        ANOMALIES.forEach(a => {
            const item = document.createElement('div');
            item.className = 'list-item';
            item.innerHTML = `<div>#${a.id} ${USER.level >= a.lvl ? a.code : 'CLASSIFIED'}</div>`;
            item.onclick = () => {
                document.getElementById('ano-content').style.display = 'block';
                document.getElementById('a-title').innerText = "ОБЪЕКТ " + a.id;
                typeText(document.getElementById('a-desc'), USER.level >= a.lvl ? a.desc : "ДОСТУП ЗАПРЕЩЕН", document.getElementById('ano-viewer'));
            };
            list.appendChild(item);
        });
    }

    async function loadStaff() {
        try {
            const res = await fetch(`${RENDER_API}/get-staff`);
            const db = await res.json();
            const list = document.getElementById('staff-list');
            Object.entries(db).forEach(([id, p]) => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `<div>${USER.level >= p.level ? (p.name || id) : 'RESTRICTED'}</div>`;
                item.onclick = () => {
                    document.getElementById('staff-content').style.display = 'block';
                    document.getElementById('s-img').src = `https://minotar.net/armor/bust/${p.mc_name || 'Steve'}/160.png`;
                    document.getElementById('s-name').innerText = p.name || id;
                    typeText(document.getElementById('s-bio'), USER.level >= p.level ? (p.bio || "Нет данных") : "ЗАБЛОКИРОВАНО", document.getElementById('staff-viewer'));
                };
                list.appendChild(item);
            });
        } catch(e) {}
    }

    async function loadArchive() {
        const list = document.getElementById('archive-list');
        try {
            const res = await fetch(`${GITHUB_JSON}?t=${Date.now()}`);
            const files = await res.json();
            files.reverse().forEach(f => {
                const item = document.createElement('div');
                item.className = 'list-item';
                item.innerHTML = `<div>${USER.level >= f.level ? f.title : 'LOCKED'}</div>`;
                item.onclick = () => {
                    document.getElementById('archive-content').style.display = 'block';
                    document.getElementById('r-title').innerText = f.title;
                    typeText(document.getElementById('r-text'), USER.level >= f.level ? f.content : "ОШИБКА ДОСТУПА", document.getElementById('archive-viewer'));
                };
                list.appendChild(item);
            });
        } catch(e) {}
    }

    function typeText(el, text, container) {
        if(typeTimer) clearInterval(typeTimer);
        el.innerText = "";
        if(container) container.scrollTop = 0;
        let i = 0;
        typeTimer = setInterval(() => {
            el.innerText = text.substring(0, i);
            i++;
            if(i > text.length) clearInterval(typeTimer);
        }, 5);
    }
</script>
</body>
</html>
