<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>P.R.I.S.M. | Public Portal</title>
    <style>
    :root { 
        --neon-green: #00ffcc; 
        --alert-red: #ff4444; 
        --bg-dark: #050505; 
        --panel-bg: rgba(10, 15, 15, 0.9); 
        --border-color: #1a3a3a;
    }
    body { 
        background: var(--bg-dark); 
        color: #d1d1d1; 
        font-family: 'Courier New', monospace; 
        margin: 0; 
        overflow-x: hidden; 
        padding-bottom: 60px; 
    }
    /* –§–æ–Ω–æ–≤–∞—è —Å–µ—Ç–∫–∞ */
    body::before {
        content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-image: linear-gradient(var(--border-color) 1px, transparent 1px), linear-gradient(90deg, var(--border-color) 1px, transparent 1px);
        background-size: 50px 50px; opacity: 0.05; pointer-events: none; z-index: -1;
    }
    /* –≠—Ñ—Ñ–µ–∫—Ç —à—É–º–∞ */
    .overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: repeating-linear-gradient(0deg, rgba(0,0,0,0.05) 0px, transparent 1px);
        pointer-events: none; z-index: 1000;
    }
    nav { 
        background: rgba(0,0,0,0.9); padding: 20px; border-bottom: 1px solid var(--border-color); 
        text-align: center; backdrop-filter: blur(5px); 
    }
    nav a { 
        color: #555; text-decoration: none; text-transform: uppercase; 
        padding: 0 25px; transition: 0.3s; font-weight: bold; font-size: 0.9em; letter-spacing: 2px; 
    }
    nav a:hover { color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green); }

    .container { max-width: 1100px; margin: 40px auto; padding: 0 20px; }

    .main-header {
        text-align: center; margin-bottom: 60px; border: 1px solid var(--border-color); padding: 40px;
        background: linear-gradient(180deg, rgba(0, 255, 204, 0.05) 0%, transparent 100%); position: relative;
    }

    .card { 
        background: var(--panel-bg); border: 1px solid var(--border-color); padding: 30px; 
        margin-bottom: 25px; position: relative; box-shadow: inset 0 0 20px rgba(0,0,0,0.5); 
    }
    .card::before { content: ""; position: absolute; top: -1px; left: -1px; width: 15px; height: 15px; border-top: 2px solid var(--neon-green); border-left: 2px solid var(--neon-green); }
    .card::after { content: ""; position: absolute; bottom: -1px; right: -1px; width: 15px; height: 15px; border-bottom: 2px solid var(--neon-green); border-right: 2px solid var(--neon-green); }

    .status-bar {
        border: 1px solid var(--border-color); padding: 25px; 
        display: flex; justify-content: space-between; align-items: center;
        background: rgba(0, 255, 204, 0.02); margin-bottom: 25px; /* –ß—É—Ç—å —É–º–µ–Ω—å—à–∏–ª –æ—Ç—Å—Ç—É–ø */
    }

    .dot { width: 14px; height: 14px; border-radius: 2px; background: var(--neon-green); box-shadow: 0 0 15px var(--neon-green); animation: pulse 1.5s infinite; }

    .btn {
        background: rgba(0, 255, 204, 0.05); border: 1px solid var(--neon-green);
        color: var(--neon-green); padding: 15px 40px; cursor: pointer;
        text-transform: uppercase; font-weight: bold; transition: 0.4s; letter-spacing: 3px;
    }
    .btn:hover { background: var(--neon-green); color: #000; box-shadow: 0 0 25px var(--neon-green); }

    #emergency-alert {
        display: none; position: fixed; bottom: 0; left: 0; width: 100%;
        background: var(--alert-red); color: #000; padding: 15px 0;
        font-weight: 900; z-index: 2000; text-transform: uppercase;
        border-top: 2px solid #000; border-bottom: 2px solid #000; box-shadow: 0 0 30px var(--alert-red);
    }

    .scanline {
        position: fixed; top: 0; left: 0; width: 100%; height: 4px;
        background: rgba(0, 255, 204, 0.05); z-index: 1001; pointer-events: none;
        animation: scan 10s linear infinite;
    }

    /* Input –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏ */
    #user-input { background: transparent; border: none; color: #fff; outline: none; font-family: inherit; width: 100%; font-size: 1em; }
    
    @keyframes scan { from { top: -5%; } to { top: 105%; } }
    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
    @keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }

    .counter-num { display: block; font-size: 3em; color: var(--neon-green); text-shadow: 0 0 10px rgba(0, 255, 204, 0.3); }
    .alert-marquee { white-space: nowrap; display: inline-block; animation: marquee 30s linear infinite; font-size: 1.2em; letter-spacing: 5px; }
    </style>
</head>
<body>

<div class="overlay"></div>
<div class="scanline"></div>
<audio id="alarm-sound" loop><source src="alarm.mp3" type="audio/mpeg"></audio>
<div id="emergency-alert"></div>

<nav>
    <a href="index.html" style="color: var(--neon-green);">[ –ì–õ–ê–í–ù–ê–Ø ]</a>
    <a href="storage.html">–ë–ò–ë–õ–ò–û–¢–ï–ö–ê</a>
    <a href="dossier.html">–õ–ò–ß–ù–´–ï –î–ï–õ–ê</a>
    <a href="radarPlayer.html">–†–ê–î–ê–†</a>
    <a href="staff.html">–¢–ï–†–ú–ò–ù–ê–õ</a>
</nav>

<div class="container">
    <div class="main-header">
        <h1 style="letter-spacing: 20px; color: var(--neon-green); margin: 0; font-size: 3em;">P.R.I.S.M.</h1>
        <p style="color: #555; margin-top: 15px; letter-spacing: 2px;">Proactive Reaction, Immediate Solution & Minimization of Anomalies.</p>
    </div>

    <div class="status-bar">
        <div style="display: flex; align-items: center; gap: 20px;">
            <div class="dot" id="status-dot"></div>
            <div>
                <div style="font-size: 0.7em; color: #666; letter-spacing: 1px;">SYSTEM_INTEGRITY</div>
                <div id="status-text" style="font-weight: bold; letter-spacing: 2px;">CONNECTING...</div>
            </div>
        </div>
        <div style="text-align: right;">
            <div style="font-size: 0.7em; color: #666;">SERVER_TIME</div>
            <div id="clock" style="color: var(--neon-green); font-weight: bold;">00:00:00</div>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
        <div class="card">
            <div style="font-size: 0.7em; color: #666; margin-bottom: 15px;">CONNECTION_METRICS</div>
            <div id="user-info" style="font-size: 0.9em; line-height: 1.8;">
                <div>IP: <span id="user-ip" style="color: var(--neon-green);">127.0.0.1</span></div>
                <div>LOC: <span id="user-loc" style="color: var(--neon-green);">SCANNING...</span></div>
                <div>SEC: <span style="color: var(--neon-green);">ENCRYPTED (TLS 1.3)</span></div>
            </div>
        </div>

        <div class="card" style="display: flex; flex-direction: column; min-height: 150px;">
            <div style="font-size: 0.7em; color: #666; margin-bottom: 10px;">USER_CONSOLE</div>
            <div id="mini-console-output" style="flex-grow: 1; height: 60px; overflow: hidden; font-size: 0.8em; color: #888; display: flex; flex-direction: column-reverse;">
                <div>Ready...</div>
            </div>
            <div style="border-top: 1px solid #333; margin-top: 10px; padding-top: 10px; display: flex; align-items: center;">
                <span style="color: var(--neon-green); margin-right: 10px; font-weight: bold;">></span>
                <input type="text" id="user-input" placeholder="Type command..." autocomplete="off" spellcheck="false">
            </div>
        </div>
    </div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
        <div class="card" style="text-align: center;">
            <span style="font-size: 0.7em; color: #666;">PROBABILITY_OF_COLLAPSE</span>
            <span class="counter-num" id="risk-percent">0.0031%</span>
        </div>
        <div class="card" style="text-align: center;">
            <span style="font-size: 0.7em; color: #666;">RIFT_RESONANCE_INDEX</span>
            <span class="counter-num" id="resonance-index">1.0000</span>
        </div>
    </div>

    <div class="card" style="background: #000; border-color: #1a1a1a;">
        <div style="font-size: 0.7em; color: #444; margin-bottom: 15px; border-bottom: 1px solid #1a1a1a; padding-bottom: 5px;">LIVE_CONSOLE_FEED v2.0.26</div>
        <div id="system-log" style="height: 150px; overflow: hidden; font-size: 0.85em; color: #008877; line-height: 1.4;"></div>
    </div>

    <div class="card">
        <h3 style="color: var(--neon-green); margin-top: 0;">OBJECTIVE_DATA</h3>
        <p style="line-height: 1.6;">–ú—ã ‚Äî –≤–Ω–µ–≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞–Ω–æ–º–∞–ª–∏–π. –ù–∞—à–∞ –∑–∞–¥–∞—á–∞: –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –¥–µ—Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏.</p>
        <p style="color: #777; font-size: 1em; border-left: 2px solid var(--neon-green); padding-left: 15px;">"–í —Ç–µ–º–Ω–æ—Ç–µ –º—ã ‚Äî —Å–≤–µ—Ç. –í —Ö–∞–æ—Å–µ –º—ã ‚Äî –ø–æ—Ä—è–¥–æ–∫. –í –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º—ã - —â–∏—Ç."</p>
    </div>

    <div class="card">
        <h3 style="color: var(--neon-green); margin-top: 0;">CLASSIFIED_INFO</h3>
        <p style="line-height: 1.6;">–°—Ç–∞—Ç—É—Å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ú—ã —è–≤–ª—è–µ–º—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.</p>
        <p style="line-height: 1.6;">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –∑–∞—Å–µ–∫—Ä–µ—á–µ–Ω–Ω–æ–π –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–æ–≤–Ω–æ –≤ —Ç–æ–º –æ–±—ä–µ–º–µ, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –¥–æ–≤–µ—Ä–∏—è.</p>
        <p style="line-height: 1.6;">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –õ–∏—á–Ω–æ—Å—Ç–∏ –°–æ–∑–¥–∞—Ç–µ–ª–µ–π –∞–Ω–æ–Ω–∏–º–Ω—ã.</p>
        <p style="line-height: 1.6;">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ê–Ω–æ–º–∞–ª–∏–π: –ö –∞–Ω–æ–º–∞–ª—å–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º –æ—Ç–Ω–æ—Å—è—Ç—Å—è –Ω–µ–≥—É–º–∞–Ω–æ–∏–¥–Ω—ã–µ —Å—É–±—ä–µ–∫—Ç—ã, –æ–±–ª–∞–¥–∞—é—â–∏–µ –¥–µ—Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—â–∏–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏, –∞ —Ç–∞–∫–∂–µ —Å–æ–±—ã—Ç–∏—è, –Ω–∞—Ä—É—à–∞—é—â–∏–µ –±–∞–∑–æ–≤—ã–µ –∑–∞–∫–æ–Ω—ã —Ñ–∏–∑–∏–∫–∏.</p>
        <p style="line-height: 1.6;">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü–æ—Å—Ç-–º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Ä–∞—Å—ã (–≤–∫–ª—é—á–∞—è –º–∏—Ä –ë–ª–∏–Ω–∫) –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–æ–º –∞–Ω–æ–º–∞–ª–∏–∏.</p>
        <p style="line-height: 1.6;">–ó–Ω–∞–Ω–∏–µ ‚Äî —ç—Ç–æ —â–∏—Ç. –ú—ã –¥–µ—Ä–∂–∏–º –µ–≥–æ –¥–ª—è –≤–∞—Å.</p>
        <div style="text-align: center; margin-top: 40px;">
            <button class="btn" onclick="location.href='staff.html'">IDENTIFY_PERSONNEL</button>
        </div>
    </div>
</div>

<script>
    const RENDER_API = "https://prism-bot.onrender.com"; 
    let isAlarmPlaying = false;
    let audioUnlocked = false;
    let lastState = "NORMAL";

    document.body.addEventListener('click', () => { audioUnlocked = true; }, { once: true });

    function updateClock() {
        const clockElement = document.getElementById('clock');
        if(clockElement) clockElement.innerText = new Date().toLocaleTimeString();
    }

    // –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –õ–û–ì–ê
    function sysLog(msg, type = 'INFO') {
        const logContainer = document.getElementById('system-log');
        if (!logContainer) return;

        const time = new Date().toLocaleTimeString();
        const typeColors = { 'INFO': '#00ffcc', 'WARN': '#ffd700', 'ERROR': '#ff4444', 'SYNC': '#00ff41', 'CORE': '#ff00ff' };

        let formattedMsg = msg
            .replace(/(–í–ù–ò–ú–ê–ù–ò–ï|–û–®–ò–ë–ö–ê|–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô|üö®)/g, '<span style="color: #ff4444; font-weight: bold;">$1</span>')
            .replace(/(–°–¢–ê–¢–£–°|–ü–†–û–¢–û–ö–û–õ|–°–ò–°–¢–ï–ú–ê|–Ø–î–†–û)/g, '<span style="color: #ffd700;">$1</span>')
            .replace(/(–£–°–ü–ï–®–ù–û|–°–¢–ê–ë–ò–õ–ï–ù|–û–ö)/g, '<span style="color: #00ff41;">$1</span>');

        const line = document.createElement('div');
        line.style.marginBottom = "4px";
        line.innerHTML = `<span style="color: #444;">[${time}]</span> <span style="color: ${typeColors[type] || '#888'}">${type}</span> > ${formattedMsg}`;
        logContainer.prepend(line);
        if (logContainer.children.length > 15) logContainer.removeChild(logContainer.lastChild);
    }

    // –õ–û–ì–ò–ö–ê –ö–û–ù–°–û–õ–ò
    function executeCmd(cmd) {
        const miniOut = document.getElementById('mini-console-output');
        sysLog(`User Input: ${cmd.toUpperCase()}`, "CORE");
        
        let response = "";
        if (cmd === 'help') response = "CMDS: status, clear, login, scan";
        else if (cmd === 'clear') { 
            if(miniOut) miniOut.innerHTML = ''; 
            response = "Cleared."; 
        }
        else if (cmd === 'status') response = "System: ONLINE. Metrics: STABLE.";
        else if (cmd === 'scan') response = "Scanning local network... 0 threats.";
        else if (cmd === 'login') response = "Access Denied. Biometrics required.";
        else response = `Unknown command: ${cmd}`;

        if(miniOut && cmd !== 'clear') {
            const l = document.createElement('div');
            l.style.color = "#aaa";
            l.innerText = `> ${response}`;
            miniOut.prepend(l);
        }
    }

    // FETCH DATA
    async function fetchVisitorData() {
        const ipElem = document.getElementById('user-ip');
        const locElem = document.getElementById('user-loc');
        
        // –ú–∞—Å—Å–∏–≤ —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä–∞ (–µ—Å–ª–∏ –æ–¥–∏–Ω –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π)
        const services = [
            'https://api.db-ip.com/v2/free/self',
            'https://ipapi.co/json/', // –¢–æ—Ç, —á—Ç–æ —É –≤–∞—Å –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª—Å—è
            'https://ip-api.com/json/'
        ];

        for (let url of services) {
            try {
                const res = await fetch(url);
                if (!res.ok) throw new Error('Status not OK');
                const data = await res.json();
                
                // –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª–µ–π (—Ä–∞–∑–Ω—ã–µ API –Ω–∞–∑—ã–≤–∞—é—Ç –∏—Ö –ø–æ-—Ä–∞–∑–Ω–æ–º—É)
                const ip = data.ipAddress || data.ip || "127.0.0.1";
                const city = data.city || "Unknown";
                const country = data.countryCode || data.country || "??";

                ipElem.innerText = ip;
                locElem.innerText = `${city}, ${country}`;
                sysLog(`–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —á–µ—Ä–µ–∑ ${new URL(url).hostname}`, "SYNC");
                return; // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã
            } catch (e) {
                console.warn(`–°–µ—Ä–≤–∏—Å ${url} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.`);
            }
        }

        // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ
        ipElem.innerText = "MASKED_NODE";
        locElem.innerText = "LOCAL_HUB";
        ipElem.style.color = "var(--alert-red)";
        sysLog("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ —Å–≤—è–∑–∏. –õ–∏—á–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç–∞.", "WARN");
    }

    async function syncPrism() {
        try {
            const response = await fetch(`${RENDER_API}/status`);
            const data = await response.json();
            if (Math.random() > 0.8) sysLog(`–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —É–∑–ª–æ–º: –ø–∏–Ω–≥ ${(Math.random()*50).toFixed(0)}ms`, 'SYNC');
            updateUI(data.state, data.label, data.color);
        } catch (e) {
            if (lastState !== "OFFLINE") {
                sysLog("–ü–û–¢–ï–†–Ø –°–í–Ø–ó–ò –° –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ú –Ø–î–†–û–ú!", "ERROR");
                lastState = "OFFLINE";
            }
            const statusTxt = document.getElementById('status-text');
            statusTxt.innerText = "OFFLINE";
            statusTxt.style.color = "gray";
        }
    }

    function updateSensors() {
        const riskElem = document.getElementById('risk-percent');
        const resonanceElem = document.getElementById('resonance-index');
        if (!riskElem || !resonanceElem) return;

        let risk, resonance;
        if (isAlarmPlaying) {
            risk = (Math.random() * 80 + 15).toFixed(4);
            resonance = (Math.random() * 4 + 0.1).toFixed(4);
            riskElem.style.color = "var(--alert-red)";
            resonanceElem.style.color = "var(--alert-red)";
            riskElem.style.transform = `translateX(${Math.random()*2-1}px)`;
        } else {
            risk = (0.001 + (Math.sin(Date.now() / 5000) * 0.0005) + Math.random() * 0.0002).toFixed(4);
            resonance = (1.0000 + (Math.sin(Date.now() / 3000) * 0.0008)).toFixed(4);
            riskElem.style.color = "var(--neon-green)";
            resonanceElem.style.color = "var(--neon-green)";
            riskElem.style.transform = "none";
        }
        riskElem.innerText = `${risk}%`;
        resonanceElem.innerText = resonance;
    }

    function updateUI(state, label, color) {
        const statusTxt = document.getElementById('status-text');
        const statusDot = document.getElementById('status-dot');
        const alertBanner = document.getElementById('emergency-alert');
        const alarm = document.getElementById('alarm-sound');

        if (state !== lastState) {
            if (state === "RED") sysLog("üö® –í–ù–ò–ú–ê–ù–ò–ï: –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ—Ç–æ–∫–æ–ª RED_CODE!", "ERROR");
            else if (lastState !== "NORMAL") sysLog("–°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞. –†–µ–∂–∏–º NORMAL.", "SYNC");
            lastState = state;
        }

        statusTxt.innerText = label.toUpperCase();
        statusTxt.style.color = color;
        statusDot.style.backgroundColor = color;
        statusDot.style.boxShadow = `0 0 15px ${color}`;

        if (state === "RED") {
            if (alertBanner.style.display !== "block") {
                const alertMsg = " –í–ù–ò–ú–ê–ù–ò–ï: –ó–ê–§–ò–ö–°–ò–†–û–í–ê–ù–û –ù–ê–†–£–®–ï–ù–ò–ï –ü–†–û–¢–û–ö–û–õ–û–í P.R.I.S.M. –°–û–•–†–ê–ù–Ø–ô–¢–ï –°–ü–û–ö–û–ô–°–¢–í–ò–ï. ‚Äî ";
                alertBanner.innerHTML = `<div class="alert-marquee">${alertMsg.repeat(15)}</div>`;
                alertBanner.style.display = "block";
            }
            document.body.style.backgroundColor = "#1a0000";
            if (audioUnlocked && alarm && !isAlarmPlaying) {
                isAlarmPlaying = true;
                alarm.volume = 0.2;
                alarm.play().catch(e => console.log("Audio play blocked"));
            }
        } else {
            alertBanner.style.display = "none";
            document.body.style.backgroundColor = "#050505";
            if (alarm) { alarm.pause(); alarm.currentTime = 0; }
            isAlarmPlaying = false;
        }
    }

    function generateBackgroundLog() {
        const templates = [
            () => `–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö Alpha-${Math.floor(Math.random()*10)}: —Å—Ç–∞–±–∏–ª–µ–Ω.`,
            () => `–†–µ–∑–æ–Ω–∞–Ω—Å –†–∞–∑–ª–æ–º–∞: ${document.getElementById('resonance-index').innerText}`,
            () => `–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –æ–±–æ–ª–æ—á–∫–∏: ${(99 + Math.random()).toFixed(3)}%`,
            () => `–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ç–æ—Ä–∞ ${(Math.random()*10).toFixed(0)}: —á–∏—Å—Ç–æ.`,
            () => `–°–≤—è–∑—å —Å —É–∑–ª–æ–º Delta —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –ü–∏–Ω–≥: ${(Math.random()*50).toFixed(0)}ms`,
            () => `Uptime —Ç–µ—Ä–º–∏–Ω–∞–ª–∞: ${(performance.now() / 1000).toFixed(0)} —Å–µ–∫.`,
            () => `–ê–∫—Ç–∏–≤–Ω–∞—è –∑–æ–Ω–∞ –∑–∞—Ö–≤–∞—Ç–∞: ${window.innerWidth}x${window.innerHeight} (Viewport)`,
        ];
        sysLog(templates[Math.floor(Math.random() * templates.length)](), 'INFO');
        setTimeout(generateBackgroundLog, Math.random() * 3000 + 4000);
    }

    let lastMoveLog = 0;
    window.addEventListener('mousemove', (e) => {
        let now = Date.now();
        if (now - lastMoveLog > 10000) { 
            sysLog(`–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–æ–º–µ—Ç—Ä–∏–∏ –≤ —Å–µ–∫—Ç–æ—Ä–µ [X:${e.clientX} Y:${e.clientY}]... OK`, 'CORE');
            lastMoveLog = now;
        }
    });

    window.addEventListener('mousedown', () => {
        sysLog("–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ: –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–∞–∫—Ç —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.", "WARN");
    });

    // INIT
    setInterval(updateSensors, 150);
    setInterval(updateClock, 1000);
    setInterval(syncPrism, 4000);
    
    // Console Input Listener
    const input = document.getElementById('user-input');
    const miniOut = document.getElementById('mini-console-output');
    if(input) {
        input.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const val = input.value.trim();
                if (val) {
                    const l = document.createElement('div');
                    l.innerHTML = `<span style="color: var(--neon-green)">></span> ${val.toUpperCase()}`;
                    if (miniOut) {
                        miniOut.prepend(l);
                        if (miniOut.children.length > 5) miniOut.removeChild(miniOut.lastChild);
                    }
                    executeCmd(val.toLowerCase());
                }
                input.value = '';
            }
        });
    }

    updateClock();
    syncPrism();
    fetchVisitorData();
    generateBackgroundLog();

    document.querySelector('.btn').addEventListener('click', () => {
        sysLog("–ó–∞–ø—Ä–æ—Å –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª–∞...", "WARN");
    });
</script>
</body>
</html>



